// ignore_for_file: avoid_redundant_argument_values

import 'package:freerasp/freerasp.dart';

class TalsecService {
  static Future<void> initialize() async {
    final config = TalsecConfig(
      androidConfig: AndroidConfig(
        packageName: 'com.aheaditec.freeraspExample',
        signingCertHashes: ['AKoRuyLMM91E7lX/Zqp3u4jMmd0A7hH/Iqozu0TMVd0='],
        supportedStores: ['com.sec.android.app.samsungapps'],
        malwareConfig: MalwareConfig(
          blocklistedPackageNames: ['com.aheaditec.freeraspExample'],
          blocklistedPermissions: [
            ['android.permission.CAMERA'],
            ['android.permission.READ_SMS', 'android.permission.READ_CONTACTS'],
          ],
        ),
      ),
      iosConfig: IOSConfig(
        bundleIds: ['com.aheaditec.freeraspExample'],
        teamId: 'M8AK35...',
      ),
      watcherMail: 'your_mail@example.com',
      isProd: true,
    );

    await Talsec.instance.start(config);
  }

  static Future<void> whitelistApp(SuspiciousAppInfo malware) async {
     await Talsec.instance.addToWhitelist(malware.packageInfo.packageName);
  }
}

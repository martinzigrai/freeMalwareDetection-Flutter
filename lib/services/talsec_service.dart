// ignore_for_file: avoid_redundant_argument_values

import 'package:freerasp/freerasp.dart';

class TalsecService {
  static Future<void> initialize() async {
    final config = TalsecConfig(
      androidConfig: AndroidConfig(
        // ❗️ Do not retrieve any package information dynamically using
        // ❗️ package_info_plus or similar packages. These can return false
        // ❗️ information when the app is spoofed.
        packageName: 'app.talsec.free_malware_detection',
        signingCertHashes: ['AKoRuyLMM91E7lX/Zqp3u4jMmd0A7hH/Iqozu0TMVd0='],
        supportedStores: ['com.sec.android.app.samsungapps'],
        malwareConfig: MalwareConfig(
          blacklistedPackageNames: ['com.google.android.youtube'],
          // Apps CANNOT have these (groups) of permissions
          suspiciousPermissions: [
            [
              'android.permission.CAMERA',
            ],
            /* OR */
            [
              'android.permission.READ_SMS',
              /* AND */
              'android.permission.READ_CONTACTS'
            ],
          ],
        ),
      ),
      watcherMail: 'your_mail@example.com',
      isProd: true,
    );

    await Talsec.instance.start(config);
  }

  static Future<void> whitelistApp(SuspiciousAppInfo malware) async {
    await Talsec.instance.addToWhitelist(malware.packageInfo.packageName);
  }
}
